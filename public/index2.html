<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title></title>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/milligram/1.2.4/milligram.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>

	<style>
		#addsentence {
			/*margin-left: auto;
			margin-right: auto;
			text-align: center;*/
		}

		#add {
			text-transform: uppercase;
			font-size: 14px;
			font-weight: bold;
		}

		#newsentence {
			width: 300px;
		}

		#newsentence {
			height: 30px;
			width: 300px;
		}

		#display {
			margin-left: auto;
			margin-right: auto;
			/*text-align: center;*/
		}

		.revise {
			width: 30px;
			font-size: 10px;
			text-align: left;
		}
	</style>
</head>
<body>
	<div class="container">
		<div class="navig"></div>

		<div id="addsentence">
			<span id="add">Add a sentence &nbsp;</span>
			<input type="text" placeholder="Your sentence here" id="newsentence" name="newsentence"><button class="button-clear" id="submitnewsentence">submit</button>
		</div>
		
		<div id="display">
			
		</div>

	</div>	

	<script>
	$(document).ready(function(){
    //display all (original) sentences in mysql/jaws db. 
    ///'sentences' route is called in server.js
    function displayOriginalSentences(){
	    var display = $('#display');
   		var currentLocation = window.location.origin;

	    $.get(currentLocation + "/sentences", function(data){
	    	for (var i = 0; i < data.length; i++) {
	    		//create new blockquote HTML element
	    		var sentenceBlock = $('<blockquote>');
	    		//assign 'original' class to the sentence
	    		sentenceBlock.addClass('original');
	    		//retrieve sentence, assign it to var sentence.
	    		var sentence = data[i].original;
	    		//retrieve its id# in sql/jaws db
	    		var id = data[i].id;
	    		//assign the same id # as an HTML/CSS property
	    		sentenceBlock.attr('id', id);
	    		//assign text to the <blockquote> element
	    		sentenceBlock.append(sentence);

	    		var sentenceButton = $('<button>').text('Revise');
	    		sentenceButton.addClass('button-clear');
	    		sentenceButton.addClass('revise');
	    		sentenceBlock.append(sentenceButton);
	    		console.log(data[i]);
	    		//attach blockquote element to parent div
	    		display.append(sentenceBlock);
	    		// console.log(data[i].original);
	    		// console.log(data[i].id);
	    	}
	    });
    }

    displayOriginalSentences();

    //add a new (original) sentence to the sql/jaws db
    //'/addsentence' route is called in server.js
   

		$('#submitnewsentence').click(function(){
    	var currentLocation = window.location.origin;
			var newphrase = $('#newsentence').val();
			//sending submitted sentence as an object was necessary to send to server without errors
			newphrase = {'original': newphrase};
			$.post(currentLocation+'/addsentence', newphrase, function(data){
				// console.log(newphrase);
				window.location.reload();
				$('#newsentence').val('');
			});
		});

		//when a 'revise' button is clicked, 
		$(document).on('click', '.revise', function () {
    	// console.log(this.id);
		});

		//alternate to $('.original').on('click'), which didn't work for some reason
		$(document).on('click', '.original', function(){
			var currentLocation = window.location.origin;
			//http://stackoverflow.com/questions/545978/finding-the-id-of-a-parent-div-using-jquery
			var id = $(this).closest("blockquote").prop("id");
			console.log(id);
			var URL = currentLocation + '/revisions/' + id; 
			$.get(URL, function(data){
				console.log(URL);
			});
		});

		
		//need this for jQuery to function properly
		return false; //$(document).ready();
	});

//sample code
// $.post(currentLocation + '/adduser', userInfo, function(data){
// 			console.log(status);
// 			$('#icon_prefix').val();
// 			$('#icon_email').val();
// 			$('#icon_password').val();
// 		});

	</script>
</body>
</html>
